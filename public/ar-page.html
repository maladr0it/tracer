<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.5.0/aframe/build/aframe-ar.js"></script>
  </head>
  <body style="margin : 0px; overflow: hidden;">
    <a-scene embedded arjs="trackingMethod: best; debugUIEnabled: false;">
      <a-marker preset="hiro">
        <a-plane
          src="favicon.ico"
          height="1"
          width="1"
          rotation="-90 0 0"
          position="1, 0, 0"
        ></a-plane>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
    <script>
      const markerEl = document.querySelector('a-marker');
      console.log(document.querySelector('a-plane').isObject3D);

      receiveMessage = event => {
        const newImageURL = JSON.parse(event.data);
        updateImage(newImageURL);
      };

      const updateImage = newImageURL => {
        // remove old
        const planeEl = document.querySelector('a-plane');
        planeEl.parentNode.removeChild(planeEl);
        // add new
        const newPlaneEl = document.createElement('a-plane');
        newPlaneEl.setAttribute('src', newImageURL);
        newPlaneEl.setAttribute('height', '1');
        newPlaneEl.setAttribute('width', '1');
        newPlaneEl.setAttribute('rotation', '-90 0 0');
        newPlaneEl.setAttribute('position', '1 0 0');
        markerEl.appendChild(newPlaneEl);
      };

      document.addEventListener('DOMContentLoaded', () => {
        window.addEventListener('message', receiveMessage, false);
      });
    </script>
  </body>
</html>
